# æ•°æ®åº“æ–‡æ¡£

æœ¬ç›®å½•åŒ…å«S100æµ·äº‹æœåŠ¡ç³»ç»Ÿçš„æ•°æ®åº“è®¾è®¡ã€ç§å­æ•°æ®ã€æ¨¡æ‹Ÿæ•°æ®ç­‰ç›¸å…³æ–‡æ¡£ã€‚

## ğŸ—„ï¸ æ•°æ®åº“æ¦‚è¿°

S100æµ·äº‹æœåŠ¡ç³»ç»Ÿä½¿ç”¨Prisma ORMé…åˆSQLiteæ•°æ®åº“ï¼ˆå¼€å‘ç¯å¢ƒï¼‰æˆ–PostgreSQLæ•°æ®åº“ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰è¿›è¡Œæ•°æ®ç®¡ç†ã€‚

### ğŸ“‹ æ•°æ®åº“æŠ€æœ¯æ ˆ
- **ORM**: Prisma
- **æ•°æ®åº“**: SQLite (å¼€å‘) / PostgreSQL (ç”Ÿäº§)
- **è¿ç§»å·¥å…·**: Prisma Migrate
- **ç§å­æ•°æ®**: Prisma Seed

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒæ•°æ®æ¨¡å‹
- **ç”¨æˆ·ç®¡ç†** - ç”¨æˆ·ã€è§’è‰²ã€æƒé™
- **èŠ‚ç‚¹ç®¡ç†** - èŠ‚ç‚¹å±‚æ¬¡ã€èƒ½åŠ›ã€è¦†ç›–èŒƒå›´
- **æœåŠ¡ç®¡ç†** - æœåŠ¡æ³¨å†Œã€å‘å¸ƒã€ç›‘æ§
- **æ•°æ®é›†ç®¡ç†** - æ•°æ®é›†ã€å…ƒæ•°æ®ã€å‘å¸ƒçŠ¶æ€
- **åœ°å›¾é…ç½®** - åº•å›¾é…ç½®ã€å›¾å±‚è®¾ç½®

### æ•°æ®åº“å…³ç³»å›¾
```
User (ç”¨æˆ·)
â”œâ”€â”€ Role (è§’è‰²)
â”œâ”€â”€ Permission (æƒé™)
â””â”€â”€ NodeAssignment (èŠ‚ç‚¹åˆ†é…)

Node (èŠ‚ç‚¹)
â”œâ”€â”€ NodeType (èŠ‚ç‚¹ç±»å‹)
â”œâ”€â”€ NodeCapability (èŠ‚ç‚¹èƒ½åŠ›)
â”œâ”€â”€ NodeCoverage (èŠ‚ç‚¹è¦†ç›–èŒƒå›´)
â””â”€â”€ NodeBaseMapConfig (èŠ‚ç‚¹åº•å›¾é…ç½®)

Service (æœåŠ¡)
â”œâ”€â”€ ServiceType (æœåŠ¡ç±»å‹)
â”œâ”€â”€ ServiceStatus (æœåŠ¡çŠ¶æ€)
â””â”€â”€ ServiceEndpoint (æœåŠ¡ç«¯ç‚¹)

Dataset (æ•°æ®é›†)
â”œâ”€â”€ DatasetType (æ•°æ®é›†ç±»å‹)
â”œâ”€â”€ DatasetMetadata (æ•°æ®é›†å…ƒæ•°æ®)
â””â”€â”€ DatasetPublication (æ•°æ®é›†å‘å¸ƒ)
```

## ğŸŒ± ç§å­æ•°æ®

### ç§å­æ•°æ®ç»“æ„
```
prisma/seed/
â”œâ”€â”€ index.ts              # ç§å­æ•°æ®å…¥å£
â”œâ”€â”€ run-seed.ts          # ç§å­æ•°æ®è¿è¡Œè„šæœ¬
â”œâ”€â”€ test-seed.ts         # æµ‹è¯•ç§å­æ•°æ®
â”œâ”€â”€ USAGE.md             # ç§å­æ•°æ®ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ README.md            # ç§å­æ•°æ®è¯´æ˜
â”œâ”€â”€ system/              # ç³»ç»Ÿé…ç½®ç§å­
â”‚   â”œâ”€â”€ 01-system-config.seed.ts
â”‚   â””â”€â”€ 02-sample-posts.seed.ts
â”œâ”€â”€ auth/                # è®¤è¯ç›¸å…³ç§å­
â”‚   â”œâ”€â”€ 01-user-scenarios.seed.ts
â”‚   â”œâ”€â”€ 02-role-permissions.seed.ts
â”‚   â”œâ”€â”€ 03-scenario-roles.seed.ts
â”‚   â””â”€â”€ 04-users.seed.ts
â”œâ”€â”€ nodes/               # èŠ‚ç‚¹ç›¸å…³ç§å­
â”‚   â”œâ”€â”€ 01-node-hierarchy.seed.ts
â”‚   â””â”€â”€ 02-node-capabilities.seed.ts
â”œâ”€â”€ services/            # æœåŠ¡ç›¸å…³ç§å­
â”‚   â”œâ”€â”€ 01-services.seed.ts
â”‚   â””â”€â”€ 02-service-directory.seed.ts
â””â”€â”€ datasets/            # æ•°æ®é›†ç›¸å…³ç§å­
    â””â”€â”€ 01-datasets.seed.ts
```

### ç§å­æ•°æ®ä½¿ç”¨
```bash
# è¿è¡Œç§å­æ•°æ®
npm run db:seed

# é‡ç½®æ•°æ®åº“å¹¶è¿è¡Œç§å­
npm run db:reset

# ä»…è¿è¡Œæµ‹è¯•ç§å­
npm run db:seed:test
```

## ğŸ­ æ¨¡æ‹Ÿæ•°æ®

### æ¨¡æ‹Ÿæ•°æ®ç»“æ„
```
mock-data/
â”œâ”€â”€ README.md            # æ¨¡æ‹Ÿæ•°æ®è¯´æ˜
â”œâ”€â”€ index.ts             # æ¨¡æ‹Ÿæ•°æ®å…¥å£
â”œâ”€â”€ users/               # ç”¨æˆ·æ¨¡æ‹Ÿæ•°æ®
â”‚   â””â”€â”€ users.ts
â”œâ”€â”€ nodes/               # èŠ‚ç‚¹æ¨¡æ‹Ÿæ•°æ®
â”‚   â””â”€â”€ nodes.ts
â”œâ”€â”€ services/            # æœåŠ¡æ¨¡æ‹Ÿæ•°æ®
â”‚   â””â”€â”€ services.ts
â”œâ”€â”€ datasets/            # æ•°æ®é›†æ¨¡æ‹Ÿæ•°æ®
â”‚   â””â”€â”€ datasets.ts
â”œâ”€â”€ s100/                # S100æ ‡å‡†æ•°æ®
â”‚   â””â”€â”€ s100.ts
â”œâ”€â”€ s101/                # S101æ ‡å‡†æ•°æ®
â”‚   â”œâ”€â”€ wms/
â”‚   â”‚   â””â”€â”€ navigation-layer.json
â”‚   â””â”€â”€ wfs/
â”‚       â””â”€â”€ depth-features.json
â”œâ”€â”€ s102/                # S102æ ‡å‡†æ•°æ®
â”‚   â”œâ”€â”€ wms/
â”‚   â”‚   â””â”€â”€ bathymetry-layer.json
â”‚   â””â”€â”€ wcs/
â”‚       â””â”€â”€ bathymetry-grid.tiff.metadata
â”œâ”€â”€ s104/                # S104æ ‡å‡†æ•°æ®
â”‚   â””â”€â”€ wms/
â”‚       â””â”€â”€ water-level.json
â”œâ”€â”€ s111/                # S111æ ‡å‡†æ•°æ®
â”‚   â””â”€â”€ wfs/
â”‚       â””â”€â”€ current-vectors.json
â””â”€â”€ capabilities/        # èƒ½åŠ›æ•°æ®
    â””â”€â”€ capabilities.ts
```

### æ¨¡æ‹Ÿæ•°æ®ç”¨é€”
- **å¼€å‘æµ‹è¯•** - æä¾›å¼€å‘å’Œæµ‹è¯•æ‰€éœ€çš„æ ·æœ¬æ•°æ®
- **åŠŸèƒ½æ¼”ç¤º** - æ”¯æŒç³»ç»ŸåŠŸèƒ½çš„æ¼”ç¤ºå’Œå±•ç¤º
- **APIæµ‹è¯•** - ä¸ºAPIæ¥å£æä¾›æµ‹è¯•æ•°æ®
- **UIå¼€å‘** - æ”¯æŒå‰ç«¯ç•Œé¢çš„å¼€å‘å’Œè°ƒè¯•

## ğŸ”„ æ•°æ®åº“æ“ä½œ

### å¸¸ç”¨æ•°æ®åº“å‘½ä»¤
```bash
# æ¨é€schemaåˆ°æ•°æ®åº“
npm run db:push

# ç”ŸæˆPrismaå®¢æˆ·ç«¯
npm run db:generate

# åˆ›å»ºè¿ç§»æ–‡ä»¶
npm run db:migrate:dev

# åº”ç”¨è¿ç§»
npm run db:migrate:deploy

# æŸ¥çœ‹æ•°æ®åº“
npm run db:studio

# é‡ç½®æ•°æ®åº“
npm run db:reset
```

### æ•°æ®åº“ç§å­æ“ä½œ
```bash
# è¿è¡Œæ‰€æœ‰ç§å­æ•°æ®
npm run db:seed

# è¿è¡Œç‰¹å®šç§å­æ–‡ä»¶
npx tsx prisma/seed/run-seed.ts

# è¿è¡Œæµ‹è¯•ç§å­
npx tsx prisma/seed/test-seed.ts
```

## ğŸ“‹ æ•°æ®æ ‡å‡†

### S100ç³»åˆ—æ ‡å‡†æ”¯æŒ
- **S-101** - ç”µå­æµ·å›¾ï¼ˆENCï¼‰
- **S-102** - é«˜ç²¾åº¦æ°´æ·±æ•°æ®
- **S-104** - åŠ¨æ€æ°´ä½ä¿¡æ¯
- **S-111** - å®æ—¶æµ·æµæ•°æ®
- **S-124** - èˆªè¡Œè­¦å‘Šä¿¡æ¯

### æ•°æ®æ ¼å¼æ ‡å‡†
- **WMS** - Webåœ°å›¾æœåŠ¡
- **WFS** - Webè¦ç´ æœåŠ¡
- **WCS** - Webè¦†ç›–æœåŠ¡
- **GeoJSON** - åœ°ç†æ•°æ®äº¤æ¢æ ¼å¼

## ğŸ”§ æ•°æ®ç®¡ç†æœ€ä½³å®è·µ

### 1. æ•°æ®åº“è®¾è®¡
- éµå¾ªæ•°æ®åº“èŒƒå¼è®¾è®¡
- ä½¿ç”¨é€‚å½“çš„ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢
- å®ç°æ•°æ®å®Œæ•´æ€§çº¦æŸ
- è€ƒè™‘æ•°æ®å®‰å…¨å’Œéšç§ä¿æŠ¤

### 2. ç§å­æ•°æ®ç®¡ç†
- ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç®¡ç†ç§å­æ•°æ®
- æä¾›æ•°æ®éªŒè¯å’Œæ¸…ç†
- æ”¯æŒä¸åŒç¯å¢ƒçš„ç§å­æ•°æ®
- å®ç°ç§å­æ•°æ®çš„å¢é‡æ›´æ–°

### 3. æ¨¡æ‹Ÿæ•°æ®ç®¡ç†
- ä¿æŒæ¨¡æ‹Ÿæ•°æ®çš„çœŸå®æ€§
- æä¾›å¤šæ ·åŒ–çš„æ•°æ®æ ·æœ¬
- æ”¯æŒåŠ¨æ€æ•°æ®ç”Ÿæˆ
- å®ç°æ¨¡æ‹Ÿæ•°æ®çš„ç‰ˆæœ¬ç®¡ç†

### 4. æ•°æ®è¿ç§»
- ä½¿ç”¨Prismaè¿ç§»å·¥å…·
- ä¿æŒè¿ç§»çš„å¯é€†æ€§
- æä¾›è¿ç§»å›æ»šæ–¹æ¡ˆ
- è®°å½•è¿ç§»å†å²å’Œå˜æ›´

## ğŸ“Š æ•°æ®ç›‘æ§

### æ•°æ®åº“æ€§èƒ½ç›‘æ§
- æŸ¥è¯¢æ€§èƒ½åˆ†æ
- ç´¢å¼•ä½¿ç”¨æƒ…å†µ
- è¿æ¥æ± çŠ¶æ€
- å­˜å‚¨ç©ºé—´ä½¿ç”¨

### æ•°æ®è´¨é‡ç›‘æ§
- æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
- æ•°æ®ä¸€è‡´æ€§éªŒè¯
- æ•°æ®æ›´æ–°é¢‘ç‡
- æ•°æ®è®¿é—®æ¨¡å¼

---

*æœ€åæ›´æ–°: 2024-01-01*